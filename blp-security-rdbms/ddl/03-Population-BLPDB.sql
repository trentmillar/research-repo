USE BLPDB
GO

--POPULATE BELL-LAPADULA MODEL
SET IDENTITY_INSERT agency.[COMPARTMENT] ON
GO

--insert COMPARTMENT table
	INSERT INTO [agency].[COMPARTMENT] ([COMPARTMENT_ID], [COMPARTMENT_NAME]) VALUES (1, 'None'); -- WIDE OPEN
	INSERT INTO [agency].[COMPARTMENT] ([COMPARTMENT_ID], [COMPARTMENT_NAME]) VALUES (2, 'Desert Shield');
	INSERT INTO [agency].[COMPARTMENT] ([COMPARTMENT_ID], [COMPARTMENT_NAME]) VALUES (3, 'Operation SMOOTH');
	INSERT INTO [agency].[COMPARTMENT] ([COMPARTMENT_ID], [COMPARTMENT_NAME]) VALUES (4, 'Project X');
GO
	
SET IDENTITY_INSERT agency.[COMPARTMENT] OFF
GO

SET IDENTITY_INSERT agency.[CLASSIFICATION] ON
GO

--insert CLASSIFICATION table
	INSERT INTO [agency].[CLASSIFICATION] ([CLASSIFICATION_ID], [CLASSIFICATION_NAME]) VALUES (1, 'Unclassified'); -- WIDE OPEN
	INSERT INTO [agency].[CLASSIFICATION] ([CLASSIFICATION_ID], [CLASSIFICATION_NAME]) VALUES (2, 'Restricted');
	INSERT INTO [agency].[CLASSIFICATION] ([CLASSIFICATION_ID], [CLASSIFICATION_NAME]) VALUES (3, 'Classified');
	INSERT INTO [agency].[CLASSIFICATION] ([CLASSIFICATION_ID], [CLASSIFICATION_NAME]) VALUES (4, 'Top Secret');
GO

SET IDENTITY_INSERT agency.[CLASSIFICATION] OFF
GO

SET IDENTITY_INSERT agency.[USER] ON
GO

--insert USER table
	INSERT INTO [agency].[USER] ([USER_ID], [USER_NAME], [USER_PASSWORD], [CLASSIFICATION_ID]) VALUES (1, 'jdoe', 'p@ssw0rd1', 2);
	INSERT INTO [agency].[USER] ([USER_ID], [USER_NAME], [USER_PASSWORD]) VALUES (2, 'asmith', 'p@ssw0rd2');
	INSERT INTO [agency].[USER] ([USER_ID], [USER_NAME], [USER_PASSWORD]) VALUES (3, 'tanderson', 'p@ssw0rd3');
GO

SET IDENTITY_INSERT agency.[USER] OFF
GO

--adding them as users to the RDBMS
CREATE USER [jdoe] WITHOUT LOGIN WITH DEFAULT_SCHEMA = [agency]
CREATE USER asmith WITHOUT LOGIN WITH DEFAULT_SCHEMA = [agency]
CREATE USER tanderson WITHOUT LOGIN WITH DEFAULT_SCHEMA = [agency]

exec sp_addrolemember 'BLRole', 'jdoe'
exec sp_addrolemember 'BLRole', 'asmith'
exec sp_addrolemember 'BLRole', 'tanderson'
--exec sp_addrolemember 'BLRole', 'dbo'
GO

--insert USER_COMPARTMENT_CLASSIFICATION table
	INSERT INTO [agency].[USER_COMPARTMENT_CLASSIFICATION] ([USER_ID], COMPARTMENT_ID, CLASSIFICATION_ID) VALUES (1, 1, 1);
	INSERT INTO [agency].[USER_COMPARTMENT_CLASSIFICATION] ([USER_ID], COMPARTMENT_ID, CLASSIFICATION_ID) VALUES (2, 1, 1);
	INSERT INTO [agency].[USER_COMPARTMENT_CLASSIFICATION] ([USER_ID], COMPARTMENT_ID, CLASSIFICATION_ID) VALUES (3, 1, 1);
	INSERT INTO [agency].[USER_COMPARTMENT_CLASSIFICATION] ([USER_ID], COMPARTMENT_ID, CLASSIFICATION_ID) VALUES (1, 3, 3); -- jdoe under smooth has Classified access
	